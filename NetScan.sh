#!/bin/bash
function standard_scan {

local host="$line"
echo "Creating Directory for ip address of $host"
mkdir $host
echo "Traversing into Directory of $host"
cd $host
echo "Scanning All TCPPorts"
nmap -p- -v -oN AllTCPPorts --host-timeout 10m $host
echo "Scanning TCPPorts Done!"
#echo "Scanning top 999 UDP ports"
#sudo nmap -sU -v -top-ports 999 -oN udp1 $host
#echo "Scanning Top UDP ports Done!"
echo "Scanning for Vulnerabilities"
nmap --script vuln -v -oN VulnScan $host
echo "Scanning for Vulns done!"
echo "Scanning for Malware-Host"
nmap -sV --script=http-malware-host -v -oN MalwareHost $host
echo "Scanning for Malware-Host done!"
echo "Scanning for Slowloris"
nmap --script http-slowloris-check -v -oN Slowloris $host
echo "Scanning for Slowloris done!"
echo "Scanning for Telnet"
nmap -p 23 --script telnet-encryption -v -oN TelnetEncrypt $host
echo "Scanning for Telnet done!"
echo "All Scanning Completed for $host, exiting directory"
sleep 1

cd ..
}

echo "Commencing Startup"

Network_File="$1"

echo "ip addresses ready"

while read -r line; do
echo "Starting scanning of IP address: $line"
standard_scan
done < $Network_File
